<div class="member-details-container">
  <div class="member-header">
    <h2>{{ member().firstName }} {{ member().lastName }}</h2>
    <p class="member-id">Member ID: {{ member().memberId }}</p>
  </div>

  <div class="tabs-container">
    <nav class="tabs" role="tablist">
      <button 
        class="tab-button"
        [class.active]="activeTab() === 'demographics'"
        (click)="setActiveTab('demographics')"
        role="tab"
        [attr.aria-selected]="activeTab() === 'demographics'"
        type="button"
      >
        Demographics
      </button>
      <button 
        class="tab-button"
        [class.active]="activeTab() === 'claims'"
        (click)="setActiveTab('claims')"
        role="tab"
        [attr.aria-selected]="activeTab() === 'claims'"
        type="button"
      >
        Claims ({{ claims().length }})
      </button>
      <button 
        class="tab-button"
        [class.active]="activeTab() === 'benefits'"
        (click)="setActiveTab('benefits')"
        role="tab"
        [attr.aria-selected]="activeTab() === 'benefits'"
        type="button"
      >
        Benefits
      </button>
      <button 
        class="tab-button"
        [class.active]="activeTab() === 'deductibles'"
        (click)="setActiveTab('deductibles')"
        role="tab"
        [attr.aria-selected]="activeTab() === 'deductibles'"
        type="button"
      >
        Deductibles
      </button>
      <button 
        class="tab-button"
        [class.active]="activeTab() === 'authorizations'"
        (click)="setActiveTab('authorizations')"
        role="tab"
        [attr.aria-selected]="activeTab() === 'authorizations'"
        type="button"
      >
        Prior Authorizations
      </button>
    </nav>

    <div class="tab-content">
      @switch (activeTab()) {
        @case ('demographics') {
          <div class="demographics-panel" role="tabpanel">
            <h3>Personal Information</h3>
            <div class="info-grid">
              <div class="info-item">
                <label>Full Name:</label>
                <span>{{ member().firstName }} {{ member().lastName }}</span>
              </div>
              <div class="info-item">
                <label>Date of Birth:</label>
                <span>{{ formatDate(member().dateOfBirth) }}</span>
              </div>
              <div class="info-item">
                <label>Email:</label>
                <span>{{ member().email }}</span>
              </div>
              <div class="info-item">
                <label>Phone:</label>
                <span>{{ member().phone }}</span>
              </div>
            </div>

            <h3>Address</h3>
            <div class="address-info">
              <p>{{ member().address.street }}</p>
              <p>{{ member().address.city }}, {{ member().address.state }} {{ member().address.zipCode }}</p>
            </div>

            @if (member().familyMembers.length > 0) {
              <h3>Family Members</h3>
              <div class="family-members">
                @for (familyMember of member().familyMembers; track familyMember.id) {
                  <div class="family-member-card">
                    <div class="family-member-info">
                      <strong>{{ familyMember.firstName }} {{ familyMember.lastName }}</strong>
                      <span class="relationship">{{ familyMember.relationship }}</span>
                      <span class="dob">DOB: {{ formatDate(familyMember.dateOfBirth) }}</span>
                    </div>
                  </div>
                }
              </div>
            }
          </div>
        }

        @case ('claims') {
          <div class="claims-panel" role="tabpanel">
            <h3>Claims History</h3>
            @if (claims().length === 0) {
              <p class="no-data">No claims found for this member.</p>
            } @else {
              <div class="claims-table">
                <div class="table-header">
                  <div class="col">Claim Number</div>
                  <div class="col">Date of Service</div>
                  <div class="col">Provider</div>
                  <div class="col">Diagnosis</div>
                  <div class="col">Amount</div>
                  <div class="col">Status</div>
                </div>
                @for (claim of claims(); track claim.id) {
                  <div class="table-row">
                    <div class="col">{{ claim.claimNumber }}</div>
                    <div class="col">{{ formatDate(claim.dateOfService) }}</div>
                    <div class="col">{{ claim.provider }}</div>
                    <div class="col">{{ claim.diagnosis }}</div>
                    <div class="col">{{ formatCurrency(claim.amount) }}</div>
                    <div class="col">
                      <span [class]="getStatusClass(claim.status)">{{ claim.status | titlecase }}</span>
                    </div>
                  </div>
                }
              </div>
            }
          </div>
        }

        @case ('benefits') {
          <div class="benefits-panel" role="tabpanel">
            <h3>Benefit Information</h3>
            @if (benefits().length === 0) {
              <p class="no-data">No benefits information available.</p>
            } @else {
              @for (benefit of benefits(); track benefit.id) {
                <div class="benefit-card">
                  <h4>{{ benefit.benefitType }} - {{ benefit.description }}</h4>
                  <div class="benefit-details">
                    <div class="benefit-item">
                      <label>Coverage Amount:</label>
                      <span>{{ formatCurrency(benefit.coverageAmount) }}</span>
                    </div>
                    <div class="benefit-item">
                      <label>Deductible:</label>
                      <span>{{ formatCurrency(benefit.deductible) }}</span>
                    </div>
                    <div class="benefit-item">
                      <label>Copay:</label>
                      <span>{{ formatCurrency(benefit.copay) }}</span>
                    </div>
                    <div class="benefit-item">
                      <label>Coinsurance:</label>
                      <span>{{ benefit.coinsurance }}%</span>
                    </div>
                    <div class="benefit-item">
                      <label>Plan Year:</label>
                      <span>{{ benefit.planYear }}</span>
                    </div>
                  </div>
                </div>
              }
            }
          </div>
        }

        @case ('deductibles') {
          <div class="deductibles-panel" role="tabpanel">
            <h3>Deductible Information</h3>
            @if (deductibles().length === 0) {
              <p class="no-data">No deductible information available.</p>
            } @else {
              @for (deductible of deductibles(); track deductible.id) {
                <div class="deductible-card">
                  <h4>{{ deductible.planYear }} Plan Year</h4>
                  <div class="deductible-grid">
                    <div class="deductible-section">
                      <h5>Individual</h5>
                      <div class="deductible-item">
                        <label>Annual Deductible:</label>
                        <span>{{ formatCurrency(deductible.individualDeductible) }}</span>
                      </div>
                      <div class="deductible-item">
                        <label>Met to Date:</label>
                        <span>{{ formatCurrency(deductible.individualMet) }}</span>
                      </div>
                      <div class="deductible-item">
                        <label>Remaining:</label>
                        <span>{{ formatCurrency(deductible.remainingIndividual) }}</span>
                      </div>
                    </div>
                    <div class="deductible-section">
                      <h5>Family</h5>
                      <div class="deductible-item">
                        <label>Annual Deductible:</label>
                        <span>{{ formatCurrency(deductible.familyDeductible) }}</span>
                      </div>
                      <div class="deductible-item">
                        <label>Met to Date:</label>
                        <span>{{ formatCurrency(deductible.familyMet) }}</span>
                      </div>
                      <div class="deductible-item">
                        <label>Remaining:</label>
                        <span>{{ formatCurrency(deductible.remainingFamily) }}</span>
                      </div>
                    </div>
                  </div>
                </div>
              }
            }
          </div>
        }

        @case ('authorizations') {
          <div class="authorizations-panel" role="tabpanel">
            <h3>Prior Authorizations</h3>
            @if (authorizations().length === 0) {
              <p class="no-data">No prior authorizations found.</p>
            } @else {
              @for (auth of authorizations(); track auth.id) {
                <div class="auth-card">
                  <div class="auth-header">
                    <h4>{{ auth.serviceType }}</h4>
                    <span [class]="getStatusClass(auth.status)">{{ auth.status | titlecase }}</span>
                  </div>
                  <div class="auth-details">
                    <div class="auth-item">
                      <label>Authorization Number:</label>
                      <span>{{ auth.authNumber }}</span>
                    </div>
                    <div class="auth-item">
                      <label>Provider:</label>
                      <span>{{ auth.provider }}</span>
                    </div>
                    <div class="auth-item">
                      <label>Request Date:</label>
                      <span>{{ formatDate(auth.requestDate) }}</span>
                    </div>
                    @if (auth.approvedDate) {
                      <div class="auth-item">
                        <label>Approved Date:</label>
                        <span>{{ formatDate(auth.approvedDate) }}</span>
                      </div>
                    }
                    @if (auth.expirationDate) {
                      <div class="auth-item">
                        <label>Expiration Date:</label>
                        <span>{{ formatDate(auth.expirationDate) }}</span>
                      </div>
                    }
                    @if (auth.notes) {
                      <div class="auth-item notes">
                        <label>Notes:</label>
                        <span>{{ auth.notes }}</span>
                      </div>
                    }
                  </div>
                </div>
              }
            }
          </div>
        }
      }
    </div>
  </div>
</div>